{% extends "transcriptions/base.html" %} {% load staticfiles %}
{% block title %}{{ asset.title }}{% endblock title %}
{% block head_content %}
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://www.jqueryscript.net/demo/Bootstrap-4-Tag-Input-Plugin-jQuery/tagsinput.js"></script>
    <script src="{% static "vendor/openseadragon/openseadragon.min.js" %}"></script>
    <style>
        .tab-pane, .asset-image {
            height: 600px;
            
        }
        .asset-image {
            background-color: #eee;
            border: 1px solid #ccc;
        }
        #nav-tab { margin-bottom: .5em; }
        .tab-pane textarea {
            height: 100%;
            border: 1px solid #ccc;
        }
        .tab-content { margin-bottom: .5em; }
        /*
 * bootstrap-tagsinput v0.8.0
 * 
 */

.bootstrap-tagsinput {
  background-color: #fff;
  border: 1px solid #ccc;
  box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
  display: inline-block;
  padding: 4px 6px;
  color: #555;
  vertical-align: middle;
  border-radius: 4px;
  width: 100%;
  line-height: 22px;
  cursor: text;
}
.bootstrap-tagsinput input {
  border: none;
  box-shadow: none;
  outline: none;
  background-color: transparent;
  padding: 0 6px;
  margin: 0;
  width: auto;
  max-width: inherit;
}
.bootstrap-tagsinput.form-control input::-moz-placeholder {
  color: #777;
  opacity: 1;
}
.bootstrap-tagsinput.form-control input:-ms-input-placeholder {
  color: #777;
}
.bootstrap-tagsinput.form-control input::-webkit-input-placeholder {
  color: #777;
}
.bootstrap-tagsinput input:focus {
  border: none;
  box-shadow: none;
}
.bootstrap-tagsinput .badge {
  margin-right: 2px;
  color: white;
  background-color:#0275d8;
  padding:5px 8px;border-radius:3px;
  border:1px solid #01649e
}
.bootstrap-tagsinput .badge [data-role="remove"] {
  margin-left: 8px;
  cursor: pointer;
}
.bootstrap-tagsinput .badge [data-role="remove"]:after {
  content: "Ã—";
  padding: 0px 4px;
  background-color:rgba(0, 0, 0, 0.1);
  border-radius:50%;
  font-size:13px
}
.bootstrap-tagsinput .badge [data-role="remove"]:hover:after {

  background-color:rgba(0, 0, 0, 0.62);}
.bootstrap-tagsinput .badge [data-role="remove"]:hover:active {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
#nav-tags .bootstrap-tagsinput{
  height:100%;
}
#nav-tags .badge{
  margin-top: 5px;
}
    </style>
{% endblock head_content %}
{% block main_content %}
    <div class="container">
        <h2>{{ asset.title }}</h2>
        <p><a href="{% url 'transcriptions:collection' asset.collection.slug %}">
            <i>{{ asset.collection.title }} Collection</i></a></p>
        <p>{{ asset.description }}</p>
        <div class="row">
            <div class="col-6"></div>
            <div class="col-6">
                <nav>
                    <div class="nav nav-pills" id="nav-tab" role="tablist">
                        <a class="nav-item nav-link active" id="nav-tx-tab" data-toggle="tab" href="#nav-tx" role="tab" aria-controls="nav-tx" aria-selected="true">Transcription</a>
                        <a class="nav-item nav-link" id="nav-tags-tab" data-toggle="tab" href="#nav-tags" role="tab" aria-controls="nav-tags" aria-selected="false">Tags</a>
                        <a class="nav-item nav-link" id="nav-disc-tab" data-toggle="tab" href="#nav-disc" role="tab" aria-controls="nav-disc" aria-selected="false">Discussion</a>
                    </div>
                </nav>
            </div>
        </div>
        <div class="row">
            <div class="col-6">
                <div id="asset-image" class="asset-image">
                    <script>
                        OpenSeadragon({
                            id: 'asset-image',
                            prefixUrl: '{% static "vendor/openseadragon/images/" %}',
                            tileSources: {
                                type: 'image',
                                url: '{{ asset.media_url }}'
                                {# TODO: Temp work around to account for test data with externaly hosted images #}
                                {#url: '{{ MEDIA_URL }}{{ asset.media_url }}'#}
                            }
                        });
                    </script>
                </div>
            </div>
            <div class="col-6">
                <form method="post">
                    {% csrf_token %}
                    <div class="tab-content" id="nav-tabContent">
                        <div class="tab-pane fade show active" id="nav-tx" role="tabpanel" aria-labelledby="nav-tx-tab">
                            <textarea class="w-100" name="tx" id="tx" placeholder="Transcription">{{transcription.text}}</textarea>        
                        </div>
                        <div class="tab-pane fade" id="nav-tags" role="tabpanel" aria-labelledby="nav-tag-tab">
                          <input type="text" class="textarea w-100" id="tags"  name="tags" data-role="tagsinput" value="{%for tag in tags %}{{tag}},{% endfor %}">
                        </div>
                        <div class="tab-pane fade" id="nav-disc" role="tabpanel" aria-labelledby="nav-disc-tab" style="border: solid 1px lightgray; padding: 20px;">
                            <div class="row">
                                <div class="comments col-md-9" id="comments">
                                    <!-- comment -->
                                    <div class="comment mb-2 row">
                                        <div class="comment-avatar col-md-1 col-sm-2 text-center pr-1">
                                            <a href=""><img class="mx-auto rounded-circle img-fluid" src="http://demos.themes.guide/bodeo/assets/images/users/m103.jpg" alt="avatar"></a>
                                        </div>
                                        <div class="comment-content col-md-11 col-sm-10">
                                            <h6 class="small comment-meta"><a href="#">admin</a> Today, 2:38</h6>
                                            <div class="comment-body">
                                                <p>
                                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod 
                                                    <br>
                                                    <a href="" class="text-right small"><i class="ion-reply"></i> Reply</a>
                                                </p>
                                            </div>
                                        </div>
                                        
                                        <!-- reply is indented -->
                                        <div class="comment-reply col-md-11 offset-md-1 col-sm-10 offset-sm-2">
                                            <div class="row">
                                                <div class="comment-avatar col-md-1 col-sm-2 text-center pr-1">
                                                    <a href=""><img class="mx-auto rounded-circle img-fluid" src="http://demos.themes.guide/bodeo/assets/images/users/m101.jpg" alt="avatar"></a>
                                                </div>
                                                <div class="comment-content col-md-11 col-sm-10 col-12">
                                                    <h6 class="small comment-meta"><a href="#">phildownney</a> Today, 12:31</h6>
                                                    <div class="comment-body">
                                                        <p>Really?? Consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                                                            <br>
                                                            <a href="" class="text-right small"><i class="ion-reply"></i> Reply</a>
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                       </div>
                                       <!-- /reply is indented -->
                                    </div>
                                    <!-- /comment -->
                                    <!-- comment -->
                                    <div class="comment mb-2 row">
                                        <div class="comment-avatar col-md-1 col-sm-2 text-center pr-1">
                                            <a href=""><img class="mx-auto rounded-circle img-fluid" src="http://demos.themes.guide/bodeo/assets/images/users/w102.jpg" alt="avatar"></a>
                                        </div>
                                        <div class="comment-content col-md-11 col-sm-10">
                                            <h6 class="small comment-meta"><a href="#">maslarino</a> Yesterday, 5:03 PM</h6>
                                            <div class="comment-body">
                                                <p>Sit amet, consectetur adipisicing elit, sed do eiusmod tempor.
                                                    <br>
                                                    <a href="" class="text-right small"><i class="ion-reply"></i> Reply</a>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /comment -->
                                    <div class="row pt-2">
                                        <div class="col-12">
                                            <a href="" class="btn btn-sm btn-primary">Comment</a>
                                        </div>
                                    </div>

                                </div>
                            </div> 
                        </div>

                    </div>
                    {% if request.user.is_authenticated %}
                    <p >
                        <label for="status_id">Transcription Status:</label>
                        <select name="status" id="status_id">
                            <option value="0">0%</option>
                            <option value="25">25%</option>
                            <option value="50">50%</option>
                            <option value="75">75%</option>
                            <option value="100">100%</option>
                        </select>
                        <input type="submit" class="btn btn-primary" value="Save">
                    </p>
                    {% endif %}
                </form>
            </div>  
        </div>    
    </div>
    <script>
    {% if transcription.status %}
      $("#status_id").val({{transcription.status}});
    {% endif %}
    </script>
{% endblock main_content %}
